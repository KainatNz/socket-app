{"ast":null,"code":"var _jsxFileName = \"/home/kainat/Desktop/Voli-Chat/frontend/src/App.1.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport Peer from 'simple-peer';\nimport { Container, Grid, Paper, Typography } from '@mui/material';\nimport VideoCall from './VideoCall';\nimport { socket } from './App';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function App() {\n  _s();\n  const [stream, setStream] = useState(null);\n  const [myPeer, setMyPeer] = useState(null);\n  const [peers, setPeers] = useState([]);\n  const [audioMuted, setAudioMuted] = useState(false);\n  const [videoEnabled, setVideoEnabled] = useState(true);\n  const [targetSocketId, setTargetSocketId] = useState(null); // Added state for targetSocketId\n\n  const myVideoRef = useRef();\n  // useEffect(() => {\n  //   navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n  //     .then((userStream) => {\n  //       setStream(userStream);\n  //       myVideoRef.current.srcObject = userStream;\n  //       socket.on('your-id', (userId) => {\n  //         console.log('Your ID:', userId);\n  //         setMyPeer(new Peer({ initiator: true, trickle: false, stream: userStream }));\n  //       });\n  //       socket.on('user-connected', (userId) => {\n  //         console.log('User Connected:', userId);\n  //         connectToNewUser(userId, userStream);\n  //       });\n  //     });\n  //   return () => {\n  //     if (myPeer) myPeer.destroy();\n  //   };\n  // }, []);\n  const connectToNewUser = (userId, userStream) => {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream: userStream\n    });\n    setPeers(prevPeers => [...prevPeers, {\n      peerId: userId,\n      peer\n    }]);\n    peer.on('signal', data => {\n      setTargetSocketId(userId);\n      socket.emit('send-offer', {\n        signalData: data,\n        to: userId\n      });\n    });\n    peer.on('stream', stream => {\n      setPeers(prevPeers => prevPeers.map(p => p.peerId === userId ? {\n        ...p,\n        peer: {\n          ...p.peer,\n          stream\n        }\n      } : p));\n    });\n    socket.on('answer-call', data => {\n      const existingPeer = peers.find(p => p.peerId === userId);\n      if (existingPeer) {\n        existingPeer.peer.signal(data.signal);\n      }\n    });\n  };\n  const answerCall = () => {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream\n    });\n    peer.on('signal', data => {\n      socket.emit('send-answer', {\n        signalData: data,\n        to: targetSocketId\n      });\n    });\n    console.log('✌️targetSocketId --->', targetSocketId);\n    socket.on('receive-offer', data => {\n      if (data.from === targetSocketId) {\n        const existingPeer = peers.find(p => p.peerId === targetSocketId);\n        if (existingPeer) {\n          existingPeer.peer.signal(data.signal);\n        }\n      }\n    });\n    setPeers(prevPeers => [...prevPeers, {\n      peerId: targetSocketId,\n      peer\n    }]);\n  };\n  const toggleAudio = () => {\n    const audioTracks = stream.getAudioTracks();\n    audioTracks.forEach(track => track.enabled = !audioMuted);\n    setAudioMuted(!audioMuted);\n  };\n  const toggleVideo = () => {\n    const videoTracks = stream.getVideoTracks();\n    videoTracks.forEach(track => track.enabled = !videoEnabled);\n    setVideoEnabled(!videoEnabled);\n  };\n  console.log('✌️peers --->', peers);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 3,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        children: /*#__PURE__*/_jsxDEV(Paper, {\n          elevation: 3,\n          style: {\n            padding: '20px',\n            textAlign: 'center'\n          },\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h5\",\n            children: \"Video Chat App\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(VideoCall, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"6o4A6OoW2RWSxO/wr1OF3XyIaGc=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useRef","Peer","Container","Grid","Paper","Typography","VideoCall","socket","jsxDEV","_jsxDEV","App","_s","stream","setStream","myPeer","setMyPeer","peers","setPeers","audioMuted","setAudioMuted","videoEnabled","setVideoEnabled","targetSocketId","setTargetSocketId","myVideoRef","connectToNewUser","userId","userStream","peer","initiator","trickle","prevPeers","peerId","on","data","emit","signalData","to","map","p","existingPeer","find","signal","answerCall","console","log","from","toggleAudio","audioTracks","getAudioTracks","forEach","track","enabled","toggleVideo","videoTracks","getVideoTracks","children","container","spacing","item","xs","elevation","style","padding","textAlign","variant","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/kainat/Desktop/Voli-Chat/frontend/src/App.1.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport Peer from 'simple-peer';\nimport { Container, Grid, Paper, Typography } from '@mui/material';\nimport VideoCall from './VideoCall';\nimport { socket } from './App';\n\nexport function App() {\n  const [stream, setStream] = useState(null);\n  const [myPeer, setMyPeer] = useState(null);\n  const [peers, setPeers] = useState([]);\n  const [audioMuted, setAudioMuted] = useState(false);\n  const [videoEnabled, setVideoEnabled] = useState(true);\n  const [targetSocketId, setTargetSocketId] = useState(null); // Added state for targetSocketId\n\n  const myVideoRef = useRef();\n  // useEffect(() => {\n  //   navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n  //     .then((userStream) => {\n  //       setStream(userStream);\n  //       myVideoRef.current.srcObject = userStream;\n  //       socket.on('your-id', (userId) => {\n  //         console.log('Your ID:', userId);\n  //         setMyPeer(new Peer({ initiator: true, trickle: false, stream: userStream }));\n  //       });\n  //       socket.on('user-connected', (userId) => {\n  //         console.log('User Connected:', userId);\n  //         connectToNewUser(userId, userStream);\n  //       });\n  //     });\n  //   return () => {\n  //     if (myPeer) myPeer.destroy();\n  //   };\n  // }, []);\n  const connectToNewUser = (userId, userStream) => {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream: userStream,\n    });\n\n    setPeers((prevPeers) => [...prevPeers, { peerId: userId, peer }]);\n\n    peer.on('signal', (data) => {\n      setTargetSocketId(userId);\n      socket.emit('send-offer', { signalData: data, to: userId });\n    });\n\n    peer.on('stream', (stream) => {\n      setPeers((prevPeers) => prevPeers.map((p) => p.peerId === userId ? { ...p, peer: { ...p.peer, stream } } : p\n      )\n      );\n    });\n\n    socket.on('answer-call', (data) => {\n      const existingPeer = peers.find((p) => p.peerId === userId);\n      if (existingPeer) {\n        existingPeer.peer.signal(data.signal);\n      }\n    });\n  };\n\n\n\n  const answerCall = () => {\n    const peer = new Peer({ initiator: false, trickle: false, stream });\n\n    peer.on('signal', (data) => {\n      socket.emit('send-answer', { signalData: data, to: targetSocketId });\n    });\n    console.log('✌️targetSocketId --->', targetSocketId);\n    socket.on('receive-offer', (data) => {\n      if (data.from === targetSocketId) {\n        const existingPeer = peers.find((p) => p.peerId === targetSocketId);\n        if (existingPeer) {\n          existingPeer.peer.signal(data.signal);\n        }\n      }\n    });\n\n    setPeers((prevPeers) => [...prevPeers, { peerId: targetSocketId, peer }]);\n  };\n\n\n  const toggleAudio = () => {\n    const audioTracks = stream.getAudioTracks();\n    audioTracks.forEach((track) => (track.enabled = !audioMuted));\n    setAudioMuted(!audioMuted);\n  };\n\n  const toggleVideo = () => {\n    const videoTracks = stream.getVideoTracks();\n    videoTracks.forEach((track) => (track.enabled = !videoEnabled));\n    setVideoEnabled(!videoEnabled);\n  };\n\n\n  console.log('✌️peers --->', peers);\n  return (\n    <Container>\n      <Grid container spacing={3}>\n        <Grid item xs={12}>\n          <Paper elevation={3} style={{ padding: '20px', textAlign: 'center' }}>\n            <Typography variant=\"h5\">Video Chat App</Typography>\n          </Paper>\n        </Grid>\n        <VideoCall />\n        {/* <Grid item xs={12} md={8}>\n              <Paper elevation={3} style={{ padding: '20px' }}>\n                <video ref={myVideoRef} playsInline autoPlay muted />\n              </Paper>\n            </Grid>\n            <Grid item xs={12} md={4}>\n              <Paper elevation={3} style={{ padding: '20px', textAlign: 'center' }}>\n                <Button variant=\"contained\" color=\"primary\" onClick={answerCall}>\n                  Answer Call\n                </Button>\n                <br />\n                <br />\n                <Typography variant=\"h6\">Audio</Typography>\n                <Switch onChange={toggleAudio} checked={!audioMuted} />\n                <br />\n                <Typography variant=\"h6\">Video</Typography>\n                <Switch onChange={toggleVideo} checked={videoEnabled} />\n              </Paper>\n            </Grid>\n            <Grid item xs={12}>\n              <Paper elevation={3} style={{ padding: '20px' }}>\n                <Typography variant=\"h6\">Participants</Typography>\n                <Grid container spacing={2}>\n                  {peers.map((peer) => (\n                    <Grid item key={peer.peerId} xs={6} md={4} lg={3}>\n                      <Paper elevation={3} style={{ padding: '10px', textAlign: 'center' }}>\n                        {peer.peer.stream && (\n                          <video playsInline autoPlay ref={(ref) => ref && (ref.srcObject = peer.peer.stream)} />\n                        )}\n                      </Paper>\n                    </Grid>\n                  ))}\n                </Grid>\n              </Paper>\n            </Grid> */}\n\n      </Grid>\n    </Container>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}